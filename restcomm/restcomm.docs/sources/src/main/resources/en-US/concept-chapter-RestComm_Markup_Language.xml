<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "RestComm_User_Guide.ent">
%BOOK_ENTITIES;
]>
<!-- chapter id nickname: ittsss -->
<chapter>
	<title>RestComm Markup Language</title>
	<para>The RestComm Markup Language (RCML) is composed of a set of XML tags that can be used to instruct
		RestComm on how to handle an on-going phone call. RestComm applications are built by combining these
		XML verbs and nouns in a way that is sensible for a given set of application requirements. In this
		chapter we will discuss what a request from RestComm to your application looks like as well as what the
		response from your application should look like. Then, we will dive in to how each verb and noun in the
		XML instruction set is used.</para>
	<section>
		<title>RestComm Request</title>
		<formalpara>
			<title>How RestComm Passes Data to Your Application</title>
			<para>The way RestComm passes data to you application depends on the request method for the given
			URI. If the request method is GET then the data is passed in the query string or the part after
			the question mark. If the request method is POST then the data is sent a multi-part form data just
			like when a browser submits a form.</para>
		</formalpara>
		<formalpara>
			<title>RestComm Voice Request</title>
			<para>Any time RestComm makes a request to you applications it will include the following data
			as request parameters.</para>
		</formalpara>
		<table frame='all'>
			<title>Request Parameters</title>
			<tgroup cols='2' align='left' colsep='1' rowsep='1'>
				<colspec colname='c1' />
				<colspec colname='c2' />
				<thead>
					<row>
						<entry align="center">Parameter</entry>
						<entry align="center">Description</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>CallSid</entry>
						<entry>The unique identifier for this call.</entry>
					</row>
					<row>
						<entry>AccountSid</entry>
						<entry>Your account id.</entry>
					</row>
					<row>
						<entry>From</entry>
						<entry>The phone number of the originator of the call.</entry>
					</row>
					<row>
						<entry>To</entry>
						<entry>The phone number of the call recipient.</entry>
					</row>
					<row>
						<entry>CallStatus</entry>
						<entry>The status of the call. The possible values are queued, ringing, in-progress, completed, busy, failed, and no-answer.</entry>
					</row>
					<row>
						<entry>ApiVersion</entry>
						<entry>The version of the RestComm API used to handle this call.</entry>
					</row>
					<row>
						<entry>Direction</entry>
						<entry>The direction of the call. The possible values are inbound and outbound-dial.</entry>
					</row>
					<row>
						<entry>CallerName</entry>
						<entry>The caller ID for the caller in the case of inbound calls.</entry>
					</row>
				</tbody>
			</tgroup>
		</table>
	</section>
	<section>
		<title>Your Response</title>
		<para>In your response to the request from RestComm you want to provide RCML that will instruct RestComm on how
		to handle the current call.</para>
		<formalpara>
			<title>MIME Types</title>
			<para>RestComm supports the MIME types described in the table below.</para>
		</formalpara>
		<table frame='all'>
			<title>Supported MIME Types</title>
			<tgroup cols='2' align='left' colsep='1' rowsep='1'>
				<colspec colname='c1' />
				<colspec colname='c2' />
				<thead>
					<row>
						<entry align="center">Parameter</entry>
						<entry align="center">Description</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>text/xml,
						application/xml</entry>
						<entry>RestComm interprets the returned document as an XML instruction set.</entry>
					</row>
				</tbody>
			</tgroup>
		</table>
		<note>
			<para>When your application returns the RCML document the root element of the document must
			always be &lt;Response&gt; or the parser will complain.</para>
		</note>
	</section>
	<section>
		<title>Say</title>
		<para>The &lt;Say&gt; verb is used to synthesize text to speech and play it to the remote party.
		The voices supported depends on the TTS Service provider plug-in. Below are the voices for our default
		TTS service provider plug-in which uses Acapela Voice and VoiceRSS (default) as a Service.</para>
		<table>
		   <title>Say Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>voice</entry>
					<entry>man, woman</entry>
					<entry>man</entry>
				</row>
				<row>
					<entry>language</entry>
					<entry>bf, bp, en, en-gb,cf, cs, dan, fi es, fr, de, el,
					it, nl, no, pl, pt, ru, ar, ca, sv, tr</entry>
					<entry>en</entry>
				</row>
				<row>
					<entry>loop</entry>
					<entry>integer > 1</entry>
					<entry>1</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>voice</title>
	    	<para>The 'voice' attribute allows you to select the gender of the voice used to synthesize
	    		the text to speech for playback.</para>
	    </formalpara>
	    <formalpara>
	    	<title>language</title>
	    	<para>The 'language' attribute allows you pick a specific language for speech synthesis.
	    		RestComm currently supports languages 'bf' (Belgium-French), 'bp' (Brazilian-Portugues), 'en' (English),
	    		'en-gb' (British-English), 'cf' (Canadian-French), 'cs' (Czech), 'dan' (Dannish), 'fi' (Finnish), 'es' (Spanish),
	    		'fr' (French), 'de' (German), 'el' (Greek), 'it' (Italian), 'nl' (Netherlands-Dutch), 'no' (Norwegian),
	    		'pl' (Polish), 'pt' (Portuguese), 'ru' (Russian), 'ar' (Saudi-Arabia Arabic), 'ca' (Spain Catalan),
	    		'sv' (Swedish), and 'tr' (Turkish).</para>
	    </formalpara>
	    <formalpara>
	    	<title>loop</title>
	    	<para>The 'loop' attribute specifies how many times you'd like the text repeated. Specifying '0' will
	    		cause the the &lt;Say&gt; verb to loop until the call is hung up.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Nesting</title>
	    	<para>The &lt;Say&gt; verb can not have any other verbs or nouns nested. Only text.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Examples</title>
	    	<para>For an example of how to use the &lt;Say&gt; verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Say&gt;Hello World&lt;/Say&gt;
		&lt;/Response&gt;
		</programlisting>

<para>The example below shows how you can set the language, voice and loop parameters of the Say Verb.</para>

	<programlisting>
	<![CDATA[
		<Response>
		<Say voice="woman" language="fr" loop="3">Bienvenue à RestComm un projet parrainé par TeleStax</Say>
		</Response>

	]]>
	</programlisting>


 <note>
	<title> Usefull Information</title>
	<itemizedlist mark='opencircle'>
	<listitem>
		<para>
		When translating text to speech, the Say verb will make assumptions about how to pronounce numbers, dates, times, amounts of money and other abbreviations.

		</para>
	</listitem>

	<listitem>
		<para>
		When saying numbers, '12345' will be spoken as "twelve thousand three hundred forty-five." Whereas '1 2 3 4 5' will be spoken as "one two three four five."
		</para>
	</listitem>
	</itemizedlist>

</note>



	</section>
	<section>
		<title>Play</title>
		<para>The &lt;Play&gt; verb is used to play an audio file to the remote party.</para>
		<table>
		   <title>Play Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>loop</entry>
					<entry>integer > 1</entry>
					<entry>1</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>loop</title>
	    	<para>The 'loop' attribute specifies how many times you'd like the audio file to be repeated. Specifying '0' will
	    		cause the the &lt;Play&gt; verb to loop until the call is hung up.</para>
	    </formalpara>
	    <table>
		   <title>Supported Audio Formats</title>
		   <tgroup cols='2' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<thead>
				<row>
					<entry align="center">MIME type</entry>
					<entry align="center">Description</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>audio/wav</entry>
					<entry>wav format audio</entry>
				</row>
				<row>
					<entry>audio/wave</entry>
					<entry>wav format audio</entry>
				</row>
				<row>
					<entry>audio/x-wav</entry>
					<entry>wav format audio</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
<note>
<title>Media Server Audio File Format</title>
<para>
The recommended audio file format is linear( 8000,16 bit , Mono ).
</para>
</note>

	    <formalpara>
	    	<title>Nesting</title>
	    	<para>The &lt;Play&gt; verb can not have any other verbs or nouns nested. Only a URL.</para>
	    </formalpara>


	    <formalpara>
	    	<title>Basic example</title>
	    	<para>For an example of how to use the &lt;Play&gt; verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Play&gt;http://foobar.com/demo.wav&lt;/Play&gt;
		&lt;/Response&gt;
		</programlisting>


	</section>
	<section>
		<title>Gather</title>
		<para>The &lt;Gather&gt; verb "gathers" digits that a caller enters into his or her telephone keypad. When the caller
			is done entering digits, RestComm submits that digits to the provided 'action' URL in an HTTP GET or POST request.
			If no input is received before timeout, &lt;Gather&gt; falls through to the next verb in the RestComm document.
			You may optionally nest &lt;Say&gt;, &lt;Play&gt;, and &lt;Pause&gt; verbs within a &lt;Gather&gt; verb while
			waiting for input. This allows you to read menu options to the caller while letting her enter a menu selection
			at any time. After the first digit is received the audio will stop playing.</para>
		<table>
		   <title>Gather Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>action</entry>
					<entry>relative or absolute URL</entry>
					<entry>current document URL</entry>
				</row>
				<row>
					<entry>method</entry>
					<entry>GET, POST</entry>
					<entry>POST</entry>
				</row>
				<row>
					<entry>timeout</entry>
					<entry>positive integer</entry>
					<entry>5 seconds</entry>
				</row>
				<row>
					<entry>finishOnKey</entry>
					<entry>any digit, #, *</entry>
					<entry>#</entry>
				</row>
				<row>
					<entry>numDigits</entry>
					<entry>integer >= 1</entry>
					<entry>unlimited</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>action</title>
	    	<para>The 'action' attribute takes an absolute or relative URL as a value. When the caller has finished
	    		entering digits RestComm will make a GET or POST request to this URL including the parameters below.
	    		If no 'action' is provided, RestComm will by default make a POST request to the current document's URL.</para>
	    </formalpara>
	    <table>
		   <title>Request Parameters</title>
		   <tgroup cols='2' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<thead>
				<row>
					<entry align="center">Parameter</entry>
					<entry align="center">Description</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>Digits</entry>
					<entry>The digits the caller pressed, excluding the finishOnKey digit.</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>method</title>
	    	<para>The 'method' attribute takes the value 'GET' or 'POST'. This tells RestComm whether to request the 'action' URL
	    		via HTTP GET or POST.</para>
	    </formalpara>
	    <formalpara>
	    	<title>timeout</title>
	    	<para>The 'timeout' attribute sets the limit in seconds that RestComm will wait for the caller to press another digit before
	    		moving on and making a request to the 'action' URL. For example, if 'timeout' is '10', RestComm will wait ten seconds for
	    		the caller to press another key before submitting the previously entered digits to the 'action' URL. RestComm waits until
	    		completing the execution of all nested verbs before beginning the timeout period.</para>
	    </formalpara>
	    <formalpara>
	    	<title>finishOnKey</title>
	    	<para>The 'finishOnKey' attribute lets you choose one value that submits the received data when entered. For example, if you
	    		set 'finishOnKey' to '#' and the user enters '1234#', RestComm will immediately stop waiting for more input when the '#' is
	    		received and will submit "Digits=1234" to the 'action' URL. Note that the 'finishOnKey' value is not sent. The allowed
	    		values are the digits 0-9, '#' , '*' and the empty string (set 'finishOnKey' to ''). If the empty string is used,
	    		&lt;Gather&gt; captures all input and no key will end the &lt;Gather&gt; when pressed. In this case RestComm will submit
	    		the entered digits to the 'action' URL only after the timeout has been reached. The value can only be a single character.</para>
	    </formalpara>
	    <formalpara>
	    	<title>numDigits</title>
	    	<para>The 'numDigits' attribute lets you set the number of digits you are expecting, and submits the data to the 'action' URL
	    		once the caller enters that number of digits.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Nesting</title>
	    	<para>You can nest the following verbs within &lt;Gather&gt;: &lt;Say&gt;, &lt;Play&gt;, &lt;Pause&gt;</para>
	    </formalpara>
	    <formalpara>
	    	<title>Examples</title>
	    	<para>For an example of how to use the &lt;Gather&gt; verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
			&lt;Response&gt;
				&lt;Gather action="handle-user-input.php" numDigits="1"&gt;
					&lt;Say&gt;Welcome to TPS.&lt;/Say&gt;
					&lt;Say&gt;For store hours, press 1.&lt;/Say&gt;
					&lt;Say&gt;To speak to an agent, press 2.&lt;/Say&gt;
					&lt;Say&gt;To check your package status, press 3.&lt;/Say&gt;
				&lt;/Gather&gt;
				&lt;!-- If customer doesn't input anything, prompt and try again. --&gt;
				&lt;Say&gt;Sorry, I didn't get your response.&lt;/Say&gt;
				&lt;Redirect&gt;handle-incoming-call.xml&lt;/Redirect&gt;
			&lt;/Response&gt;
		</programlisting>
	</section>
	<section>
		<title>Record</title>
		<para>The &lt;Record&gt; verb records the caller's voice and returns to you the URL of a file containing the audio recording.</para>
		<table>
		   <title>Record Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>action</entry>
					<entry>relative or absolute URL</entry>
					<entry>current document URL</entry>
				</row>
				<row>
					<entry>method</entry>
					<entry>GET, POST</entry>
					<entry>POST</entry>
				</row>
				<row>
					<entry>timeout</entry>
					<entry>positive integer</entry>
					<entry>5</entry>
				</row>
				<row>
					<entry>finishOnKey</entry>
					<entry>any digit, #, *</entry>
					<entry>1234567890*#</entry>
				</row>
				<row>
					<entry>maxLength</entry>
					<entry>integer greater than 1 with the number of seconds to wait</entry>
					<entry>3600 (1 hour)</entry>
				</row>
				<row>
					<entry>transcribe</entry>
					<entry>true, false</entry>
					<entry>false</entry>
				</row>
				<row>
					<entry>transcribeCallback</entry>
					<entry>relative or absolute URL</entry>
					<entry>none</entry>
				</row>
				<row>
					<entry>playBeep</entry>
					<entry>true, false</entry>
					<entry>true</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>action</title>
	    	<para>The 'action' attribute takes an absolute or relative URL as a value. When recording is finished
	    	RestComm will make a GET or POST request to this URL including the parameters below. If no 'action' is
	    	provided, &lt;Record&gt; will default to requesting the current document's URL. After making this request,
	    	RestComm will continue the current call using the RCML received in your response. Any RCML verbs occuring
	    	after a &lt;Record&gt; are unreachable. There is one exception: if RestComm receives an empty recording,
	    	it will not make a request to the 'action' URL. The current call flow will continue with the next verb in
	    	the current RCML document.</para>
	    </formalpara>
	    <table>
		   <title>Request Parameters</title>
		   <tgroup cols='2' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<thead>
				<row>
					<entry align="center">Parameter</entry>
					<entry align="center">Description</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>RecordingUrl</entry>
					<entry>The URL of the recorded audio.</entry>
				</row>
				<row>
					<entry>RecordingDuration</entry>
					<entry>The time duration of the recorded audio.</entry>
				</row>
				<row>
					<entry>Digits</entry>
					<entry>The digits the caller pressed, excluding the finishOnKey digit.</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>method</title>
	    	<para>The 'method' attribute takes the value 'GET' or 'POST'. This tells RestComm whether to
	    		request the URL via HTTP GET or POST. </para>
	    </formalpara>
	    <formalpara>
	    	<title>timeout</title>
	    	<para>The 'timeout' attribute tells RestComm to end the recording after a number of seconds of silence has passed.</para>
	    </formalpara>
	    <formalpara>
	    	<title>finishOnKey</title>
	    	<para>The 'finishOnKey' attribute lets you choose a set of digits that end the recording when entered. For example, if you
	    	set 'finishOnKey' to '#' and the caller presses '#', RestComm will immediately stop recording and submit 'RecordingUrl',
	    	'RecordingDuration', and the '#' as parameters in a request to the 'action' URL. The allowed values are the digits 0-9, '#'
	    	and '*'. Unlike &lt;Gather&gt;, you may specify more than one character as a 'finishOnKey' value.</para>
	    </formalpara>
	    <formalpara>
	    	<title>maxLength</title>
	    	<para>The 'maxLength' attribute lets you set the maximum length for the recording in seconds.</para>
	    </formalpara>
	    <formalpara>
	    	<title>transcribe</title>
	    	<para>The 'transcribe' attribute tells RestComm that you would like a text representation of the audio of the recording.</para>
	    </formalpara>
	    <formalpara>
	    	<title>transcribeCallback</title>
	    	<para>The 'transcribeCallback' attribute is used in conjunction with the 'transcribe' attribute. It allows you to specify a URL
	    	to which RestComm will make an asynchronous POST request when the transcription is complete. This is not a request for RCML
	    	and the response will not change call flow, but the request will contain the standard RCML request parameters as well as
	    	'TranscriptionStatus', 'TranscriptionText', 'TranscriptionUrl' and 'RecordingUrl'. If 'transcribeCallback' is specified,
	    	then there is no need to specify 'transcribe=true'. It is implied. If you specify 'transcribe=true' without a 'transcribeCallback',
	    	the completed transcription will be stored for you to retrieve later (see the REST API Transcriptions section), but RestComm will
	    	not asynchronously notify your application.</para>
	    </formalpara>
	    <table>
		   <title>Request Parameters</title>
		   <tgroup cols='2' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<thead>
				<row>
					<entry align="center">Parameter</entry>
					<entry align="center">Description</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>TranscriptionText</entry>
					<entry>Contains the text of the transcription.</entry>
				</row>
				<row>
					<entry>TranscriptionStatus</entry>
					<entry>The status of the transcription attempt: either 'completed' or 'failed'.</entry>
				</row>
				<row>
					<entry>TranscriptionUrl</entry>
					<entry>The URL for the transcription's REST API resource.</entry>
				</row>
				<row>
					<entry>RecordingUrl</entry>
					<entry>The URL for the transcription's source recording resource.</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>playBeep</title>
	    	<para>The 'playBeep' attribute allows you to toggle between playing a sound before the start of a recording.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Nesting</title>
	    	<para>The &lt;Record&gt; verb can not have any other verbs or nouns nested.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Examples</title>
	    	<para>For an example of how to use the &lt;Record&gt; verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Record maxLength="30"/&gt;
		&lt;/Response&gt;
		</programlisting>
	</section>
	<section>
		<title>Fax</title>
		<para>The &lt;Fax&gt; verb sends a fax to some a fax machine.</para>
		<table>
		   <title>Fax Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>to</entry>
					<entry>phone number</entry>
					<entry>see below</entry>
				</row>
				<row>
					<entry>from</entry>
					<entry>phone number</entry>
					<entry>see below</entry>
				</row>
				<row>
					<entry>action</entry>
					<entry>relative or absolute URL</entry>
					<entry>none</entry>
				</row>
				<row>
					<entry>method</entry>
					<entry>GET, POST</entry>
					<entry>POST</entry>
				</row>
				<row>
					<entry>statusCallback</entry>
					<entry>relative or absolute URL</entry>
					<entry>none</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
		<formalpara>
	    	<title>to</title>
	    	<para>The 'to' attribute takes a valid E.164 phone number as a value. RestComm will send a fax to this number.
	    	When sending a fax during an incoming call, 'to' defaults to the caller. When sending an fax during an outgoing call,
	    	'to' defaults to the called party. The value of 'to' must be a valid phone number.</para>
	    </formalpara>
	    <formalpara>
	    	<title>from</title>
	    	<para>The 'from' attribute takes a valid E.164 phone number as an argument. When sending a fax during an incoming call,
	    	'from' defaults to the calling party. When sending a fax during an outgoing call, 'from' defaults to the called party.
	    	The value of 'from' must be a valid phone number.</para>
	    </formalpara>
	    <formalpara>
	    	<title>action</title>
	    	<para>The 'action' attribute takes a URL as an argument. After processing the &lt;Fax&gt; verb, RestComm will make a GET
	    	or POST request to this URL with the form parameters 'FaxStatus' and 'FaxSid'. Using an 'action' URL, your application
	    	can receive synchronous notification that the message was successfully enqueued. If you provide an 'action' URL, RestComm
	    	will use the RCML received in your response to the 'action' URL request to continue the current call. Any RCML verbs
	    	occuring after a &lt;Fax&gt; which specifies an 'action' attribute are unreachable. If no 'action' is provided, &lt;Fax&gt;
	    	will finish and RestComm will move on to the next RCML verb in the document. If there is no next verb, RestComm will end the
	    	phone call.</para>
	    </formalpara>
	    <table>
		   <title>Request Parameters</title>
		   <tgroup cols='2' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<thead>
				<row>
					<entry align="center">Parameter</entry>
					<entry align="center">Description</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>FaxSid</entry>
					<entry>The Sid for the Sms message.</entry>
				</row>
				<row>
					<entry>FaxStatus</entry>
					<entry>The current status of the Sms message. Either 'sent' or 'failed'.</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>method</title>
	    	<para>The 'method' attribute takes the value 'GET' or 'POST'. This tells RestComm whether to request the 'action' URL via HTTP GET
	    	or POST. This attribute is modeled after the HTML form 'method' attribute.</para>
	    </formalpara>
	    <formalpara>
	    	<title>statusCallback</title>
	    	<para>The 'statusCallback' attribute takes a URL as an argument. When the fax is actually sent, or if sending fails,
	    	RestComm will make an asynchronous POST request to this URL with the parameters 'FaxStatus' and 'FaxSid'.
	    	Note, 'statusCallback' always uses HTTP POST to request the given url.</para>
	    </formalpara>
	    <table>
		   <title>Request Parameters</title>
		   <tgroup cols='2' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<thead>
				<row>
					<entry align="center">Parameter</entry>
					<entry align="center">Description</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>FaxSid</entry>
					<entry>The Sid for the fax message.</entry>
				</row>
				<row>
					<entry>FaxStatus</entry>
					<entry>The current status of the fax. Either 'sent' or 'failed'.</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>Nesting</title>
	    	<para>The &lt;Fax&gt; verb can not have any other verbs or nouns nested.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Examples</title>
	    	<para>For an example of how to use the &lt;Fax&gt; verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Fax&gt;This is a test fax.&lt;/Fax&gt;
		&lt;/Response&gt;
		</programlisting>
	</section>
	<section>
		<title>Sms</title>
		<para>The &lt;Sms&gt; verb sends an SMS message to a phone number during a phone call.</para>
		<table>
		   <title>Sms Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>to</entry>
					<entry>phone number</entry>
					<entry>see below</entry>
				</row>
				<row>
					<entry>from</entry>
					<entry>phone number</entry>
					<entry>see below</entry>
				</row>
				<row>
					<entry>action</entry>
					<entry>relative or absolute URL</entry>
					<entry>none</entry>
				</row>
				<row>
					<entry>method</entry>
					<entry>GET, POST</entry>
					<entry>POST</entry>
				</row>
				<row>
					<entry>statusCallback</entry>
					<entry>relative or absolute URL</entry>
					<entry>none</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
		<formalpara>
	    	<title>to</title>
	    	<para>The 'to' attribute takes a valid E.164 phone number as a value. RestComm will send an SMS message to this number.
	    	When sending an SMS during an incoming call, 'to' defaults to the caller. When sending an SMS during an outgoing call,
	    	'to' defaults to the called party. The value of 'to' must be a valid phone number.</para>
	    </formalpara>
	    <formalpara>
	    	<title>from</title>
	    	<para>The 'from' attribute takes a valid E.164 phone number as an argument. When sending an SMS during an incoming call,
	    	'from' defaults to the calling party. When sending an SMS during an outgoing call, 'from' defaults to the called party.</para>
	    </formalpara>
	    <formalpara>
	    	<title>action</title>
	    	<para>The 'action' attribute takes a URL as an argument. After processing the &lt;Sms&gt; verb, RestComm will make a GET
	    	or POST request to this URL with the form parameters 'SmsStatus' and 'SmsSid'. Using an 'action' URL, your application
	    	can receive synchronous notification that the message was successfully enqueued. If you provide an 'action' URL, RestComm
	    	will use the RCML received in your response to the 'action' URL request to continue the current call. Any RCML verbs
	    	occuring after an &lt;Sms&gt; which specifies an 'action' attribute are unreachable. If no 'action' is provided, &lt;Sms&gt;
	    	will finish and RestComm will move on to the next RCML verb in the document. If there is no next verb, RestComm will end the
	    	phone call.</para>
	    </formalpara>
	    <formalpara>
	    	<title>method</title>
	    	<para>The 'method' attribute takes the value 'GET' or 'POST'. This tells RestComm whether to request the 'action' URL via HTTP GET
	    	or POST. This attribute is modeled after the HTML form 'method' attribute.</para>
	    </formalpara>
	    <formalpara>
	    	<title>statusCallback</title>
	    	<para>The 'statusCallback' attribute takes a URL as an argument. When the SMS message is actually sent, or if sending fails,
	    	RestComm will make an asynchronous POST request to this URL with the parameters 'SmsStatus' and 'SmsSid'.
	    	Note, 'statusCallback' always uses HTTP POST to request the given url.</para>
	    </formalpara>
	    <table>
		   <title>Request Parameters</title>
		   <tgroup cols='2' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<thead>
				<row>
					<entry align="center">Parameter</entry>
					<entry align="center">Description</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>SmsSid</entry>
					<entry>The Sid for the Sms message.</entry>
				</row>
				<row>
					<entry>SmsStatus</entry>
					<entry>The current status of the Sms message. Either 'sent' or 'failed'.</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>Nesting</title>
	    	<para>The &lt;Sms&gt; verb can not have any other verbs or nouns nested.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Examples</title>
	    	<para>For an example of how to use the &lt;Sms&gt; verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Sms&gt;Hello World!&lt;/Sms&gt;
		&lt;/Response&gt;
		</programlisting>
		
				<note>
					<title>Sms Custom headers</title>
					<para>
						Restcomm will check for any custom headers and make use of them. 
					</para>
					<para>
						In case of an incoming SMS (incoming SIP MESSAGE) Restcomm will scan the message for any headers starting with X- and if any found will be send to
						the application server with the request (part of the query string in the case of HTTP GET or part of the message body in the case of HTTP POST)
					</para>
					<para>
						The application server can also provide some custom http headers (again starting with X-) along with the RCML response, that Restcomm will store and use them
						when creating the outgoing SMS message (in the case of RCML response is Sms).
					</para>
				</note>
		
	</section>
	<section>
		<title>Dial</title>
		<para>The &lt;Dial&gt; verb connects the current caller to another phone. If the called party picks up, the two parties are
		connected and can communicate until one hangs up. If the called party does not pick up, if a busy signal is received, or if
		the number doesn't exist, the dial verb will finish.</para>
		<table>
		   <title>Dial Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>action</entry>
					<entry>relative or absolute URL</entry>
					<entry>no default for &lt;Dial&gt;</entry>
				</row>
				<row>
					<entry>method</entry>
					<entry>GET, POST</entry>
					<entry>POST</entry>
				</row>
				<row>
					<entry>timeout</entry>
					<entry>positive integer in seconds</entry>
					<entry>30 seconds</entry>
				</row>
				<row>
					<entry>timeLimit</entry>
					<entry>positive integer (seconds)</entry>
					<entry>14400 seconds (4 hours)</entry>
				</row>
				<row>
					<entry>callerId</entry>
					<entry>a valid phone number, or client identifier if you are dialing a &lt;Client&gt;.</entry>
					<entry>Caller's callerId</entry>
				</row>
				<row>
					<entry>record</entry>
					<entry>true, false</entry>
					<entry>false</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>action</title>
	    	<para>The 'action' attribute takes a URL as an argument. When the dialed call ends, RestComm will make a GET or POST
	    	request to this URL including the parameters below. If you provide an 'action' URL, RestComm will continue the current
	    	call after the dialed party has hung up, using the RCML received in your response to the 'action' URL request.
	    	Any RCML verbs occuring after a &lt;Dial&gt; which specifies an 'action' attribute are unreachable. If no 'action'
	    	is provided, &lt;Dial&gt; will finish and RestComm will move on to the next RCML verb in the document.
	    	If there is no next verb, RestComm will end the phone call.</para>
	    </formalpara>
	    <table>
		   <title>Request Parameters</title>
		   <tgroup cols='2' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<thead>
				<row>
					<entry align="center">Parameter</entry>
					<entry align="center">Description</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>DialCallStatus</entry>
					<entry>The outcome of the &lt;Dial&gt; attempt. See the DialCallStatus section below for details.</entry>
				</row>
				<row>
					<entry>DialCallSid</entry>
					<entry>The call sid of the new call leg. This parameter is not sent after dialing a conference.</entry>
				</row>
				<row>
					<entry>DialCallDuration</entry>
					<entry>The duration in seconds of the dialed call. This parameter is not sent after dialing a conference.</entry>
				</row>

<row>
					<entry>RecordingUrl</entry>
					<entry>The URL of the recorded audio. This parameter is only sent if record="true" is set on the <filename>Dial</filename> verb, and does not include recordings from the <filename>Record</filename>  verb or Record=True on REST API calls..</entry>
				</row>

			</tbody>
		</tgroup>
	    </table>
	    <table>
		   <title>DialCallStatus Values</title>
		   <tgroup cols='2' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<thead>
				<row>
					<entry align="center">Parameter</entry>
					<entry align="center">Description</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>completed</entry>
					<entry>The called party answered the call and was connected to the caller.</entry>
				</row>
				<row>
					<entry>busy</entry>
					<entry>RestComm received a busy signal when trying to connect to the called party.</entry>
				</row>
				<row>
					<entry>no-answer</entry>
					<entry>The called party did not pick up before the timeout period passed.</entry>
				</row>
				<row>
					<entry>failed</entry>
					<entry>RestComm was unable to route to the given phone number. This is frequently caused by dialing a
					properly formated but non-existent phone number.</entry>
				</row>
				<row>
					<entry>canceled</entry>
					<entry>The call was canceled via the REST API before it was answered.</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>method</title>
	    	<para>The 'method' attribute takes the value 'GET' or 'POST'. This tells RestComm whether to request the 'action'
	    	URL via HTTP GET or POST. This attribute is modeled after the HTML form 'method' attribute.</para>
	    </formalpara>
	    <formalpara>
	    	<title>timeout</title>
	    	<para>The 'timeout' attribute sets the limit in seconds that &lt;Dial&gt; waits for the called party to answer the call.</para>
	    </formalpara>
	    <formalpara>
	    	<title>timelimit</title>
	    	<para>The 'timeLimit' attribute sets the maximum duration of the &lt;Dial&gt; in seconds.</para>
	    </formalpara>
	    <formalpara>
	    	<title>callerId</title>
	    	<para>The 'callerId' attribute lets you specify the caller ID that will appear to the called party when RestComm calls.
	    	By default, when you put a &lt;Dial&gt; in your RCML response to RestComm's inbound call request, the caller ID that
	    	the dialed party sees is the inbound caller's caller ID. If you are dialing to a &lt;Client&gt;, you can set a client
	    	identifier as the callerId attribute. For instance, if you've set up a client for incoming calls and you are dialing to
	    	it, you could set the callerId attribute to client:thomas.</para>
	    </formalpara>
	    <formalpara>
	    	<title>record</title>
	    	<para>The 'record' attribute lets you specify whether the call will be recorded or not.
	    	By default, the call is not recorded. If you set the attribute to 'true' Restcomm will start recording when the two calls are bridged</para>
	    </formalpara>
	    <note>
<title>Record attribute for Dial Conference</title>
<para>
The current release of Restcomm doesn't support recording for Dial Conference. This feature will be available in the next release
</para>
</note>
	    <formalpara>
	    	<title>Nesting</title>
	    	<para>You can nest the following nouns within &lt;Dial&gt;: &lt;Number&gt;, &lt;Client&gt;, &lt;Conference&gt;</para>
	    </formalpara>
	    <formalpara>
	    	<title>Examples</title>
	    	<para>For examples of how to use the &lt;Dial&gt; verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Dial&gt;1-444-555-666&lt;/Dial&gt;
		&lt;/Response&gt;
		</programlisting>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Dial record="true"&gt;1-444-555-666&lt;/Dial&gt;
		&lt;/Response&gt;
		</programlisting>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Dial callerId="1555666777" record="true"&gt;1-444-555-666&lt;/Dial&gt;
		&lt;/Response&gt;
		</programlisting>
		<section>
			<title>Number</title>
			<para>The &lt;Number&gt; noun specifies a phone number to dial. You can use multiple &lt;Number&gt; nouns within a
			&lt;Dial&gt; verb to simultaneously call all of them at once. The first call to pick up is connected to the current call and
			the rest are hung up.</para>
			<table>
		   <title>Number Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>sendDigits</entry>
					<entry>any digits</entry>
					<entry>none</entry>
				</row>
				<row>
					<entry>url</entry>
					<entry>any url</entry>
					<entry>none</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>sendDigits</title>
	    	<para>The 'sendDigits' attribute tells RestComm to play DTMF tones when the call is answered.
	    	This is useful when dialing a phone number and an extension. RestComm will dial the number, and
	    	when the automated system picks up, send the DTMF tones to connect to the extension.</para>
	    </formalpara>
	    <formalpara>
	    	<title>url</title>
	    	<para>The 'url' attribute allows you to specify a url for a RCML document that will run on the
	    	called party's end, after he/she answers, but before the parties are connected. You can use this RCML
	    	to privately play or say information to the called party, or provide a chance to decline the phone call
	    	using &lt;Gather&gt; and &lt;Hangup&gt;. The current caller will continue to hear ringing while the
	    	RCML document executes on the other end. RCML documents executed in this manner are not allowed to contain
	    	the &lt;Dial&gt; verb.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Examples</title>
	    	<para>For an example of how to use the &lt;Number&gt; noun see below.</para>
	    </formalpara>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Dial&gt;
				&lt;Number sendDigits="wwww1234"&gt;1-444-555-6666&lt;/Number&gt;
			&lt;/Dial&gt;
		&lt;/Response&gt;
		</programlisting>
		</section>
		<section>
			<title>Client</title>
			<para>The &lt;Client&gt; noun specifies a client identifier to dial. You can use multiple &lt;Client&gt; nouns within
			a &lt;Dial&gt; verb to simultaneously attempt a connection with many clients at once. The first client to accept the
			incoming connection is connected to the call and the other connection attempts are canceled.</para>
			<formalpara>
	    		<title>Examples</title>
	    		<para>For an example of how to use the &lt;Client&gt; none see below.</para>
	    	</formalpara>
	    	<programlisting role="XML">
			&lt;Response&gt;
				&lt;Dial&gt;
					&lt;Client&gt;thomas&lt;/Client&gt;
				&lt;/Dial&gt;
			&lt;/Response&gt;
			</programlisting>
		</section>
		<section>
			<title>Conference</title>
			<para>The &lt;Conference&gt; noun allows you to connect to a named conference room and talk with the other callers
			who have also connected to that room. The name of the room is up to you and is namespaced to your account.</para>
				<table>
		   			<title>Conference Attributes</title>
		   			<tgroup cols='3' align='left' colsep='1' rowsep='1'>
						<colspec colname='c1' />
						<colspec colname='c2' />
						<colspec colname='c3' />
						<thead>
							<row>
								<entry align="center">Name</entry>
								<entry align="center">Allowed Values</entry>
								<entry align="center">Default Value</entry>
							</row>
						</thead>
						<tbody>
							<row>
								<entry>muted</entry>
								<entry>true, false</entry>
								<entry>false</entry>
							</row>
							<row>
								<entry>beep</entry>
								<entry>true, false</entry>
								<entry>true</entry>
							</row>
							<row>
								<entry>startConferenceOnEnter</entry>
								<entry>true, false</entry>
								<entry>true</entry>
							</row>
							<row>
								<entry>endConferenceOnExit</entry>
								<entry>true, false</entry>
								<entry>false</entry>
							</row>
							<row>
								<entry>waitUrl</entry>
								<entry>RCML url, empty string</entry>
								<entry>default RestComm hold music</entry>
							</row>
							<row>
								<entry>waitMethod</entry>
								<entry>GET or POST</entry>
								<entry>POST</entry>
							</row>
							<row>
								<entry>maxParticipants</entry>
								<entry>positive integer &lt;= 40</entry>
								<entry>40</entry>
							</row>
					</tbody>
				</tgroup>
	    	</table>
	    	<formalpara>
		    	<title>muted</title>
		    	<para>The 'muted' attribute lets you specify whether a participant can speak in the conference.
		    	If this attribute is set to 'true', the participant will only be able to listen to people in the conference.</para>
		    </formalpara>
		    <formalpara>
		    	<title>beep</title>
		    	<para>The 'beep' attribute lets you specify whether a notification beep is played to the conference when a participant
		    	joins or leaves the conference.</para>
		    </formalpara>
		    <formalpara>
		    	<title>startConferenceOnEnter</title>
		    	<para>This attribute tells a conference to start when this participant joins the conference, if it is not already started.
		    	If this is false and the participant joins a conference that has not started, they are muted and hear background music
		    	until a participant joins where startConferenceOnEnter is true. This is useful for implementing moderated conferences.</para>
		    </formalpara>
		    <formalpara>
		    	<title>endConferenceOnExit</title>
		    	<para>If a participant has this attribute set to 'true', then when that participant leaves, the conference ends and all
		    	other participants drop out. This is useful for implementing moderated conferences that bridge two calls and allow either
		    	call leg to continue executing RCML if the other hangs up.</para>
		    </formalpara>
		    <formalpara>
		    	<title>waitUrl</title>
		    	<para>The 'waitUrl' attribute lets you specify a URL for music that plays before the conference has started. The URL may
		    	be a WAV or a RCML document that uses &lt;Play&gt; or &lt;Say&gt; for content. This defaults to a selection of Creative
		    	Commons licensed background music, but you can replace it with your own music and messages. If the 'waitUrl' responds with
		    	RCML, RestComm will only process &lt;Play&gt;, &lt;Say&gt;, and &lt;Redirect&gt; verbs. If you do not wish anything to play
		    	while waiting for the conference to start, specify the empty string (set 'waitUrl' to '').</para>
		    </formalpara>
		    <formalpara>
		    	<title>waitMethod</title>
		    	<para>This attribute indicates which HTTP method to use when requesting 'waitUrl'. It defaults to 'POST'. Be sure to use
		    	'GET' if you are directly requesting static audio files such as WAV files so that RestComm properly caches the files.</para>
		    </formalpara>
		    <formalpara>
		    	<title>maxParticipants</title>
		    	<para>This attribute indicates the maximum number of participants you want to allow within a named conference room. The default
		    	maximum number of participants is 40. The value must be a positive integer less than or equal to 100.</para>
		    </formalpara>
		    <formalpara>
		    	<title>Examples</title>
		    	<para>For an example of how to use the &lt;Conference&gt; noun see below.</para>
		    </formalpara>
		    <programlisting role="XML">
			&lt;Response&gt;
				&lt;Dial&gt;
					&lt;Conference&gt;1234&lt;/Conference&gt;
				&lt;/Dial&gt;
			&lt;/Response&gt;
			</programlisting>
		</section>


	<warning>
	<title>Uri noun deprecated</title>
	<para>The Uri noun has been deprecated and will no longer be available in future releases. Please use the SIP noun instead.</para>
	</warning>

		<section>
			<title>Sip</title>
			<para>The &lt;Sip&gt; noun specifies a SIP URI to dial. You can use multiple &lt;Sip&gt; nouns within
			a &lt;Dial&gt; verb to simultaneously attempt a connection with many user agents at once. The first
			user agent to accept the incoming connection is connected to the call and the other connection attempts
			are canceled.</para>
			
			<para>The <filename>Dial</filename> verb's <filename>Sip</filename>  noun lets you set up VoIP sessions by using SIP -- Session Initiation Protocol. With this feature, you can send a call to any SIP endpoint. Set up your RCML to use the <filename>Sip</filename> noun within the <filename>Dial</filename> verb.</para>

<para>
Currently, only one <filename>Sip</filename> noun may be specified per <filename>Dial</filename>, and the INVITE message may be sent to only one SIP endpoint. Also, you cannot add any other nouns (eg Number, Client) in the same <filename>Dial</filename> as the SIP. If you want to use another noun, set up a callback on the <filename>Dial</filename> to use alternate methods.
</para>
			<formalpara>
	    		<title>Examples</title>
	    		<para>For an example of how to use the &lt;Sip&gt; noun see below.</para>
	    	</formalpara>
	    	<programlisting role="XML">
			&lt;Response&gt;
				&lt;Dial&gt;
					&lt;Sip&gt;sip:alice@127.0.0.1:5080&lt;/Sip&gt;
				&lt;/Dial&gt;
			&lt;/Response&gt;
			</programlisting>

<formalpara>
<title>Authentication </title>
</formalpara>

<para>
Send username and password attributes for authentication to your SIP infrastructure as attributes on the Sip noun.
</para>

<table frame='all'>
			<title>Request Parameters</title>
			<tgroup cols='2' align='left' colsep='1' rowsep='1'>
				<colspec colname='c1' />
				<colspec colname='c2' />
				<thead>
					<row>
						<entry align="center">Attribute Name</entry>
						<entry align="center">Values</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>username</entry>
						<entry>Username for SIP authentication.</entry>
					</row>
<row>
						<entry>password</entry>
						<entry>Password for SIP authentication</entry>
					</row>
			
				</tbody>
			</tgroup>
		</table>

<formalpara>
<title>Authentication Example </title>
</formalpara>

<programlisting>
<![CDATA[

<?xml version="1.0" encoding="UTF-8"?>
<Response>
	<Dial>
		<Sip username="alice" password="secret">sip:alice@example.com</Sip>
	</Dial>
</Response>

]]>
</programlisting>


<formalpara>
<title>Custom headers</title>
</formalpara>

<para>
Send custom headers by appending them to the SIP URI -- just as you'd pass headers in a URI over HTTP. For example:
</para>

<programlisting>
<![CDATA[

<?xml version="1.0" encoding="UTF-8"?>
<Response>
	<Dial>
		<Sip>
		sip:alice@example.com?mycustomheader=tata&myotherheader=toto
		</Sip>
	</Dial>
</Response>

]]>
</programlisting>

<note>
<title>Character Limit</title>
While the SIP URI itself must be under 255 chars, the headers must be under 1024 characters.
</note>


<formalpara>
<title>Transport</title>
</formalpara>

<para>
Set a parameter on your SIP URI to specify what transport protocol you want to use. Currently, this is limited to TCP and UDP. By default, Restcomm sends your SIP INVITE over UDP. Change this by using the transport parameter:
</para>



<programlisting>
<![CDATA[

<?xml version="1.0" encoding="UTF-8"?>
<Response>
	<Dial>
		<Sip>
		sip:alice@example.com;transport=tcp
		</Sip>
	</Dial>
</Response>

]]>
</programlisting>


<formalpara>
<title>Attributes</title>
</formalpara>
 

<table frame='all'>
			<title>Request Parameters</title>
			<tgroup cols='3' align='left' colsep='1' rowsep='1'>
				<colspec colname='c1' />
				<colspec colname='c2' />
				<colspec colname='c3' />
				<thead>
					<row>
						<entry align="center">Attribute Name</entry>
						<entry align="center">Allowed Values</entry>
						<entry align="center">Default Value</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>url</entry>
						<entry>call screening url.</entry>
						<entry>none.</entry>
					</row>
<row>
						<entry>method</entry>
						<entry>GET, POST </entry>
						<entry>POST </entry>
					</row>
			
				</tbody>
			</tgroup>
		</table>



<para>
The url attribute allows you to specify a url for a RCML document that runs on the called party's end, after they answer, but before the two parties are connected. You can use this RCML to privately Play or Say information to the called party, or provide a chance to decline the phone call using Gather and Hangup. The current caller continues to hear ringing while the RCML document executes on the other end. RCML documents executed in this manner cannot contain the Dial verb.
</para>

<formalpara>
<title>method</title>
</formalpara>

<para>
The method attribute allows you to specify which HTTP method Restcomm should use when requesting the URL specified in the url attribute. The default is POST.

</para>

<formalpara>
<title>Call Screening HTTP parameters</title>
</formalpara>


<para>
When a call is answered, Restcomm passes the following parameters with its request to your screening URL (in addition to the standard RCML Voice request parameters):
</para>



<table frame='all'>
			<title>Request Parameters</title>
			<tgroup cols='2' align='left' colsep='1' rowsep='1'>
				<colspec colname='c1' />
				<colspec colname='c2' />
				<thead>
					<row>
						<entry align="center">Attribute Name</entry>
						<entry align="center">Values</entry>

					</row>
				</thead>
				<tbody>
					<row>
						<entry>SipCallId</entry>
						<entry>The SIP call ID header of the request made to the remote SIP infrastructure.</entry>
					</row>
<row>
						<entry>SipHeader</entry>
						<entry>The name/value of any X-headers returned in the 200 response to the SIP INVITE request.</entry>
					</row>
			
				</tbody>
			</tgroup>
		</table>


<formalpara>
<title>Dial Action HTTP parameters</title>
</formalpara>

<para>
Use the action callback parameters to modify your application based on the results of the SIP dial attempt:
</para>


<table frame='all'>
			<title>Request Parameters</title>
			<tgroup cols='2' align='left' colsep='1' rowsep='1'>
				<colspec colname='c1' />
				<colspec colname='c2' />
				<thead>
					<row>
						<entry align="center">Attribute Name</entry>
						<entry align="center">Values</entry>

					</row>
				</thead>
				<tbody>
					<row>
						<entry>DialSipCallId</entry>
						<entry>The SIP call ID header of the request made to the remote SIP infrastructure.</entry>
					</row>
<row>
						<entry>DialSipResponseCode</entry>
						<entry>The SIP response code as a result of the INVITE attempt.</entry>
					</row>
			
<row>
						<entry>DialSipHeader_ </entry>
						<entry>The name/value of any X-headers returned in the final response to the SIP INVITE request.</entry>
					</row>

				</tbody>
			</tgroup>
		</table>

<formalpara>
<title>Dial with Multiple Examples</title>
</formalpara>

<para>
A more complex Dial, specifying custom settings as attributes on Dial, including call screening and setting the protocol to TCP.
</para>

<programlisting>
<![CDATA[

<?xml version="1.0" encoding="UTF-8"?>
<Response>
	<Dial
		record="true"
		timeout="10"
		hangupOnStar="true"
		callerId="bob"
		method="POST"
		action="/handle_post_dial">
	<Sip
		method="POST"
		url="/handle_screening_on_answer">
		sip:alice@example.com?customheader=foo
	</Sip>
	</Dial>
</Response>

]]>
</programlisting>


		</section>

	</section>
	<section>
		<title>Hangup</title>
		<para>The &lt;Hangup&gt; verb ends a call.</para>
		<formalpara>
	    	<title>Nesting</title>
	    	<para>The &lt;Hangup&gt; verb can not have any other verbs or nouns nested.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Examples</title>
	    	<para>For an example of how to use the &lt;Hangup&gt; verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Hangup/&gt;
		&lt;/Response&gt;
		</programlisting>
	</section>
	<section>
		<title>Redirect</title>
		<para>The &lt;Redirect&gt; verb transfers control of a call to the RCML at a different URL.
			All verbs after &lt;Redirect&gt; are unreachable and ignored.</para>
		<table>
		   <title>Redirect Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>method</entry>
					<entry>GET, POST</entry>
					<entry>POST</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>method</title>
	    	<para>The 'method' attribute takes the value 'GET' or 'POST'. This tells RestComm whether to
	    		request the URL via HTTP GET or POST. </para>
	    </formalpara>
	    <formalpara>
	    	<title>Nesting</title>
	    	<para>The &lt;Redirect&gt; verb can not have any other verbs or nouns nested.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Examples</title>
	    	<para>For an example of how to use the &lt;Redirect&gt; verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Redirect&gt;http://foobar.com/instructions&lt;/Redirect&gt;
		&lt;/Response&gt;
		</programlisting>
	</section>
	<section>
		<title>Reject</title>
		<para>The &lt;Reject&gt; verb rejects an incoming call to your RestComm endpoint. This is useful for blocking unwanted calls.
			If the first verb in a RCML response is &lt;Reject&gt;, RestComm will not pick up the call. The call ends with a status of
			'busy' or 'no-answer', depending on the verb's 'reason' attribute. Any verbs after &lt;Reject&gt; are unreachable and ignored.</para>
		<table>
		   <title>Reject Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>reason</entry>
					<entry>rejected, busy</entry>
					<entry>rejected</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>reason</title>
	    	<para>The reason attribute takes the values "rejected" and "busy." This tells RestComm what message to play when
	    		rejecting a call. Selecting "busy" will play a busy signal to the caller, while selecting "rejected" will
	    		play a standard not-in-service response.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Nesting</title>
	    	<para>The &lt;Reject&gt; verb can not have any other verbs or nouns nested.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Examples</title>
	    	<para>For an example of how to use the &lt;Reject&gt; verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Reject reason="busy"/&gt;
		&lt;/Response&gt;
		</programlisting>
	</section>
	<section>
		<title>Pause</title>
		<para>The &lt;Pause&gt; verb waits silently for a specific number of seconds. If &lt;Pause&gt; is the first verb
			in a RCML response, RestComm will wait the specified number of seconds before picking up the call.</para>
		<table>
		   <title>Pause Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>length</entry>
					<entry>integer > 0</entry>
					<entry>1 second</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>
	    <formalpara>
	    	<title>length</title>
	    	<para>The 'length' attribute specifies how many seconds RestComm will wait silently before continuing on.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Nesting</title>
	    	<para>The &lt;Pause&gt; verb can not have any other verbs or nouns nested.</para>
	    </formalpara>
	    <formalpara>
	    	<title>Examples</title>
	    	<para>For an example of how to use the &lt;Pause&gt; verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
		&lt;Response&gt;
			&lt;Pause length="5"/&gt;
		&lt;/Response&gt;
		</programlisting>
	</section>



<section>
		<title>UssdCollect</title>
		<para>The UssdCollect verb is a USSD integration with Restcomm resource. When fully configured with a USSD gateway, Restcomm will send all UssdMessage to the configured gateway</para>
		

	    <formalpara>
	    	<title>Example</title>
	    	<para>For an example of how to use the USSDCollect verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
	<![CDATA[
	<Response>
		<UssdCollect action="http://my.controller.net">
			<UssdMessage> 1 for first option</UssdMessage>
			<UssdMessage> 2 for first option</UssdMessage>
			<UssdMessage> 3 for first option</UssdMessage>
		</UssdCollect>
	</Response>
	]]>
		</programlisting>


<section>
<title>UssdMessage</title>

<note>
<para>
Before you can send an USSD message you must first configure the restcomm.xml with the USSD gateway information. See <xref linkend="ussdpush-api"/> for more information.
</para>
</note>
		<para>The UssdMessage verb contains the message that Restcomm will send to the USSD gateway</para>

	    <formalpara>
	    	<title>Nesting</title>
	    	<para>The UssdMessage can be nested inside of the USSDCollect verb.</para>
	    </formalpara>

		<formalpara>
	    	<title>Examples</title>
	    	<para>For an example of how to use the USSDCollect verb see below.</para>
	    </formalpara>
	    <programlisting role="XML">
	<![CDATA[
	<Response>
		<UssdMessage>Test USSD Message</UssdMessage></UssdCollect>
	</Response>
	]]>
		</programlisting>

</section>		

<section>
<title>Language</title>
		<para>The language noun let you specify the language of the USSD message that is sent to the USSD gateway</para>



<table>
		   <title>Language Attributes</title>
		   <tgroup cols='3' align='left' colsep='1' rowsep='1'>
			<colspec colname='c1' />
			<colspec colname='c2' />
			<colspec colname='c3' />
			<thead>
				<row>
					<entry align="center">Name</entry>
					<entry align="center">Allowed Values</entry>
					<entry align="center">Default Value</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>Language</entry>
					<entry>bf, bp, en, en-gb,cf, cs, dan, fi es, fr, de, el, it, nl, no, pl, pt, ru, ar, ca, sv, th, tr</entry>
					<entry>en</entry>
				</row>
			</tbody>
		</tgroup>
	    </table>

	    <formalpara>
	    	<title>Nesting</title>
	    	<para>The Language noun cannot be nested. If not specified, English language is default</para>
	    </formalpara>
	    <formalpara>
	    	<title>Example</title>
	    	<para>For an example of how to use the USSD Language noun see below.</para>
	    </formalpara>
	    <programlisting role="XML">
	<![CDATA[
	<Response>
		<Language>fr</Language>
		<UssdMessage>Test USSD Message</UssdMessage></UssdCollect>
	</Response>
	]]>
		</programlisting>

	</section>

</section>


</chapter>
