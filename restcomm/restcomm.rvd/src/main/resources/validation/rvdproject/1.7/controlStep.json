{
    "$schema": "http://json-schema.org/draft-04/schema#",
	"title": "Say step",
	"type": "object",
	"properties": {
		"name":{"type": "string"},
		"kind": {"enum": ["control"]},
		"label": {"type": "string"},
		"title": {"type": "string"},
		"conditions":{
			"type": "array",
			"items": { "$ref": "#/definitions/condition"}
		},
		"actions":{
			"type":"array",
			"items": { "$ref": "#/definitions/action"}
		},
		"conditionExpression":{"type":"string"}
	},
	"required": ["name","kind"],
	"definitions": {
		"condition": {
			"type":"object",
			"properties": {
				"name": {"type":"string", "minLength": 1},
				"operator": {"type":"string", "enum": ["equals","notequal","greater","greaterEqual","less","lessEqual","matches"]},
				"comparison": {
					"type": "object",
					"properties": {
						"operand1": {"type":"string","minLength": 1},
						"operand2": {"type":"string","minLength": 1}
					},
					"required": ["operand1","operand2"]
				},
				"matcher": {
					"type":"object",
					"properties": {
						"text": {"type":"string","minLength": 1},
						"regex": {"type":"string","minLength": 1}
					},
					"required": ["text","regex"]
				}
			},
			"required": ["name","operator"]
		},
		"action": {
			"type":"object",
			"properties": {
				"name": {"type":"string", "minLength": 1},
				"assign": {
					"type": "object",
					"properties": {
						"expression": {"type":"string","minLength": 1},
						"varName": {"type":"string","minLength": 1},
						"varScope": { "$ref": "#/definitions/varScope"}
					},
					"required": ["expression","varName"]
				},
				"continueTo": {
					"type": "object",
					"properties": {
						"target": {"type":"string","minLength": 1}
					},
					"required": ["target"]
				},
				"capture": {
					"type": "object",
					"properties": {
						"regex": {"type":"string"},
						"data": {"type":"string"},
						"varName": {"type":"string","minLength": 1},
						"varScope": { "$ref": "#/definitions/varScope"}
					}
				}
			},
			"required": ["name"]
		},
		"varScope": {"enum": ["mod","app"]}
	}
}

