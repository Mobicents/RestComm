<ul class="nav nav-pills">
    <li class="active"><a href="#/numbers/incoming">RESTCOMM NUMBERS</a></li>
    <li><a href="#/numbers/clients">SIP CLIENTS</a></li>
    <li><a href="#/numbers/outgoing">OUTGOING CALLER IDS</a></li>
    <!--
        <li><a href="#/numbers/shortcodes">SHORT CODES</a></li>
        <li><a href="#/numbers/porting">PORTING REQUESTS</a></li>
    -->
</ul>

<div class="row-fluid">
    <div class="span12 well well-small"><h1 class="page-header"><i class="icon-phone"></i> NUMBERS</h1>  <h2 class="page-subheader"> _ RESTCOMM NUMBERS</h2></div>
</div>

<div class="row-fluid">
    <div class="span12">
        <div class="pull-left">
            <button class="btn btn-primary" ng-click="showRegisterIncomingNumber()"><i class="icon-plus"></i> Register Number</button>
        </div>
        <div ng-show="numbersList.length > 0" class="pull-right">
            <h4><i class="icon-search"></i> Search <input type="text" class="search-query" ng-model="query.phone_number"> </h4>
        </div>

        <div ng-hide="(numbersList | filter:query).length > 0" class="hero-unit no-records-alert">
            <h2><i class="icon-exclamation-sign"></i> No incoming numbers <span ng-show="numbersList.length == 0">registered</span> <span ng-show="numbersList.length > 0">matching query</span>. <small>Register one now!</small></h2>
        </div>

        <table ng-show="(numbersList | filter:query).length > 0" class="table table-striped table-hover" ng-cloak>
            <thead>
                <th class="width-20pc">NUMBER</th>
                <th class="width-20pc" colspan="2">NAME</th>
                <th>FEATURES</th>
                <th class="width-10pc">&nbsp;</th>
            </thead>
            <tbody>
            <tr ng-repeat="pn in filtered = (numbersList | filter:query)">
                <td><h4 class="text-center"><a href="#/numbers/incoming/{{pn.sid}}">{{ pn.phone_number  }}</a></h4></td>
                <td><h5 class="text-center" ng-hide="editingFriendlyName == pn.phone_number">{{ pn.friendly_name  }} </h5>
                    <h5 class="text-center" ng-show="editingFriendlyName == pn.phone_number"><input type="text" class="input-small" onkeyup="if(event.keyCode == 13) {this.blur()}" ng-model="pn.friendly_name" ng-blur="editingFriendlyName = undefined; setFriendlyName(pn)" autofocus /></h5>
                </td>
                <td><h5><i class="icon-pencil clickable" ng-click="editingFriendlyName = pn.phone_number"></i></h5></td>
                <td>
                    <span ng-show="{{ pn.voice_url.length > 0  }}"><i class="icon-microphone available-feature"></i> <small> {{ pn.voice_url  }}</small></span>
                    <span class="opacity30" ng-hide="{{ pn.voice_url.length > 0  }}"><i class="icon-microphone-off unavailable-feature"></i> <small> http://www.restcomm.org/demo/voice/</small></span>
                    <br>
                    <span ng-show="{{ pn.sms_url.length > 0  }}"><i class="icon-comment available-feature"></i> <small> {{ pn.sms_url  }}</small></span>
                    <span class="opacity30" ng-hide="{{ pn.sms_url.length > 0  }}"><i class="icon-comment-alt unavailable-feature"></i> <small> http://www.restcomm.org/demo/sms/</small></span>
                    <br>
                    <!--
                    <span ng-show="{{ $index % 4 == 1  }}"><span class="available-feature"><strong>#</strong></span> <small> {{ pn.voice_url.substring(0, pn.voice_url.indexOf("demos/") + 6) }}ussd/ussd-menu.xml </small></span>
                    <span class="opacity30" ng-hide="{{ $index % 4 == 1  }}"><span class="unavailable-feature"><strong>#</strong></span> <small> http://www.restcomm.org/demo/ussd/</small></span>
                    -->
                </td>
                <td class="text-right">
                    <div class="btn-delete-div"><button class="btn btn-danger" ng-click="confirmNumberDelete(pn)">Delete</button></div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Register New Number Modal -->
<div modal="registeringNewNumber" close="closeRegisterIncomingNumber()" options="modalOpts">
    <div class="modal-header">
        <h3><i class="icon-phone"></i> Register Number</h3>
    </div>
    <div class="modal-body">
        <dl class="dl-horizontal form-dl">
            <dt>Account SID</dt>
            <dd><input type="text" class="input-xlarge" id="new-number-account-sid" ng-model="sid" placeholder="Account SID" disabled /></dd>
            <!--<hr class="small" />-->
            <dt>Phone Number</dt>
            <dd>
                <input id="new-number-number" ng-model="newNumber.number" type="tel" placeholder="eg: 305 543987012" popover-placement="bottom" popover-trigger="focus" popover="The phone number you want to purchase. The number should be formatted starting with a '+' followed by the country code and the number in E.164 format." />
            </dd>
            <!-- Area Code not supported currently
            <dt>&nbsp;</dt><dd><div class="muted"><small class="text-bottom">OR</small></div></dd>
            <dt>Area Code</dt>
            <dd><input id="new-number-areacode" ng-model="newNumber.areaCode" type="tel" placeholder="eg.: 305" popover-placement="top" popover-trigger="focus" popover="The area code in which you'd like a new incoming phone number. Any three digit, US area code is valid. RestComm will provision a random phone number within this area code for you." /></dd>
            -->
        </dl>
        <div class="text-right">
            <button ng-click="isCollapsed = !isCollapsed" class="btn btn-small"><i class="icon-ellipsis-horizontal"></i> Optional Parameters</legend></button>
        </div>
        <div collapse="isCollapsed">
            <hr />
            <dl class="dl-horizontal form-dl">
                <dt>Friendly Name</dt>
                <dd class="form-inline">
                    <input type="text" class="input-large" id="new-number-friendly-name" placeholder="Hot Line Number" ng-model="newNumber.friendlyName" />
                </dd>
            </dl>
            <h4>Voice</h4>
            <dl class="dl-horizontal form-dl">
                <dt>Voice Request URL</dt>
                <dd class="form-inline">
                    <select class="input-small add-on" ng-init="newNumber.voiceMethod='POST'" ng-model="newNumber.voiceMethod">
                        <option>GET</option>
                        <option>POST</option>
                    </select>
                    <input type="text" id="new-number-voice-request-url" placeholder="http://restcomm-demo.appspot.com/app/voice/welcome.xml" ng-model="newNumber.voiceURL" />
                    <i class="icon-list dropdown-toggle clickable" title="Select from list..."
                            onclick="var elUL = $(this).next('ul'); $(this).next('ul').css({ top: ($(this).position().top-$(elUL).height()/2), left: ($(this).position().left-$(elUL).width()) });"></i>
                    <ul class="dropdown-menu">
                        <li ng-repeat="app in availableApps">
                            <a onclick="$(this).parent().parent().parent().children('input').val($(this).attr('title')); return false;" title="{{app.startUrl}}" href="#">{{app.name}}</a>
                        </li>
                        <li class="divider"></li>
                        <li><a href="/restcomm-rvd/" target="_blank"><i class="icon-sitemap"></i> Create New...</a></li>
                    </ul>
                </dd>
                <dt>Voice Fallback URL</dt>
                <dd class="form-inline">
                    <select class="input-small add-on" ng-init="newNumber.voiceFallbackMethod='POST'" ng-model="newNumber.voiceFallbackMethod">
                        <option>GET</option>
                        <option>POST</option>
                    </select>
                    <input type="text" id="new-number-voice-fallback-url" placeholder="http://restcomm-demo.appspot.com/app/voice/welcome.xml" ng-model="newNumber.voiceFallbackURL" />
                    <i class="icon-list dropdown-toggle clickable" title="Select from list..."
                       onclick="var elUL = $(this).next('ul'); $(this).next('ul').css({ top: ($(this).position().top-$(elUL).height()/2), left: ($(this).position().left-$(elUL).width()) });"></i>
                    <ul class="dropdown-menu">
                        <li ng-repeat="app in availableApps">
                            <a onclick="$(this).parent().parent().parent().children('input').val($(this).attr('title')); return false;" title="{{app.startUrl}}" href="#">{{app.name}}</a>
                        </li>
                        <li class="divider"></li>
                        <li><a href="/restcomm-rvd/" target="_blank"><i class="icon-sitemap"></i> Create New...</a></li>
                    </ul>
                </dd>
                <dt>Status Callback URL</dt>
                <dd class="form-inline">
                    <select class="input-small add-on" ng-init="newNumber.statusCallbackMethod='POST'" ng-model="newNumber.statusCallbackMethod">
                        <option>GET</option>
                        <option>POST</option>
                    </select>
                    <input type="text" id="new-number-status-callback-url" placeholder="http://restcomm-demo.appspot.com/app/voice/welcome.xml" ng-model="newNumber.statusCallbackURL" />
                </dd>
            </dl>
            <h4>SMS Messaging</h4>
            <dl class="dl-horizontal form-dl">
                <dt>SMS Request URL</dt>
                <dd class="form-inline">
                    <select class="input-small add-on" ng-init="newNumber.smsMethod='POST'" ng-model="newNumber.smsMethod">
                        <option>GET</option>
                        <option>POST</option>
                    </select>
                    <input type="text" class="input-large" id="new-number-sms-request-url" placeholder="http://restcomm-demo.appspot.com/app/voice/welcome.xml" ng-model="newNumber.smsURL" />
                </dd>
                <dt>SMS Fallback URL</dt>
                <dd class="form-inline">
                    <select class="input-small add-on" ng-init="newNumber.smsFallbackMethod='POST'" ng-model="newNumber.smsFallbackMethod">
                        <option>GET</option>
                        <option>POST</option>
                    </select>
                    <input type="text" class="input-large" id="new-number-sms-fallback-url" placeholder="http://restcomm-demo.appspot.com/app/voice/welcome.xml" ng-model="newNumber.smsFallbackURL" />
                </dd>
            </dl>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn cancel" ng-click="closeRegisterIncomingNumber()">Cancel</button>
        <button class="btn btn-primary" ng-click="registerIncomingNumber(newNumber)">Register</button>
    </div>
</div>
